<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Oml</title>


    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="style.css">
    <!--
    <link rel="stylesheet" href="css/theme/serif.css" id="theme">
    -->
     
    <!-- For syntax highlighting -->
    <!-- <link rel="stylesheet" href="lib/css/zenburn.css"> -->

    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
      if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
      }
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
<style>

    body {
        background: url( 'bg-main.png' );
        background-repeat:no-repeat;
        /*background-size: contain;*/
        background-size: 100% 100%;
        text-align: left;
    }
    .reveal h3 {
       /* color: #11C2F7;*/
        /* http://www.colorpicker.com/11C2F7 */
        color: rgb(32, 189, 240);
    }
    .reveal p, .reveal ul {
       /* color: #11C2F7;*/
        /* http://www.colorpicker.com/11C2F7 */
       /* padding-top: 1em; */
    }
    .reveal .slides {
        text-align: left;
        font-size: 85%;
    }
    /* This is actually done in slides.ml
    .first_page {
        background: url( 'bg-front.png' );
        background-repeat:no-repeat;
        background-size: 100% 100%;
    } */

    .id { color: #333333 ; font-style: italic }
.kw { color: #990000 ; font-weight: bold ;}
.kw1 { color: #900 ; font-weight: bold ;}
.kw2 { color: #009 ; font-weight: bold ;}
.kw3 { color: #274388 ; font-weight: bold ;}
.kw4 { color: brown ; font-weight: bold ;}
.comment { color: green ; font-style: italic ; }
.string { color: #999900; font-weight: bold ; }
.text { }
.numeric { color: #123345 ; }
.directive { font-style: italic ; color : #0000aa } ;
.escape { color: #409290 ; }
.symbol { color: orange ; font-weight: bold ; }
.symbol1 { color: #993300 ; font-weight: bold ; }
.constant { color: #999900; }
pre { font-family: courier }
pre.goodresult { background-color: #E0F0B2; margin-left: 3em; margin-right: 3em;  }
pre.badresult { background-color: #FF8080; margin-left: 3em; margin-right: 3em; }
/* Make code links visible: */
a code { text-decoration: underline; }

</style>
  </head>

  <body>
    
    <div class="reveal"><div class="slides">
<section data-background="bg-front.png" data-background-size="100% 100%" data-transition="zoom">
              <div  style="text-align: left; left: 3em; color: #eee">
                  <h2 style="color: #eee" >Oml</h2></div>

<h2 id="AStatsandMLlibraryinOCaml">A Stats and ML library in OCaml</h2>

<p><a href='http://github.com/rleonid' style='color:white'>Leonid Rozenberg</a>,<br />
<a href='http://composeconference.org' style='color:white'>Compose Conference</a>,<br /></p>
<div style='color:white'> Feb 4, 2016.</div>

</section><section><h3>Slides are available here</h3>

<p>http://rleonid.github.io/slides/oml/compose2016/index.html</p>
</section><section><h3>Who am I?</h3>

<ul><li>Software/ML dude at the <strong>Hammer Lab</strong> within the
 <strong>Icahn Institute for Genomics and Multiscale Biology</strong>
 <img src='img/proj_mountsinai.jpg' alt='Projection' />.
 Working at the intersection of biology, computers and math.<ul><li>Strong advocates of open source.</li></ul></li><li>Background in finance.</li><li>I&#39;m a <em>type</em> addict<ul><li><code>Array.fold_left</code> ... leads to thinking.</li><li><code>:set +t</code> in my <code>~/.ghci</code></li></ul></li></ul>

</section><section><h3>What am I selling?</h3>

<img class="stretch" src="img/uncle_sam.jpg" alt="UncleSam" /><ul><li class="fragment roll-in">Get involved (try it out, file an issue, share opinions ...)</li>
<li class="fragment roll-in">There are lots of interesting problems in this domain.</li>
<li class="fragment roll-in">It is important to get this <em>right</em>.</li></ul>

</section><section><h3>Getting started.</h3>

<p>Install:</p>
<pre class="terminal">  $ opam install oml
  </span></code></pre>

<p>Try it out in <code>utop</code>:</p>
<pre><span class="text">  </span><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="id">require</span><span class="text"> </span><span class="string">"oml"</span><span class="text">;;
  </span><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="id">show_module</span><span class="text"> </span><span class="kw2">Oml</span><span class="text"> ;;
  </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Oml</span><span class="text"> :
    </span><span class="kw1">sig</span><span class="text">
      </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Util</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
      </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Uncategorized</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
      </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Statistics</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
      </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Online</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
      </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Classification</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
      </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Regression</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
      </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Unsupervised</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw1">end</span><span class="text">
  </span></pre>

</section><section><h3>A quick tour part 1.</h3>

<p><code>Util</code> a <code>Pervasive</code>&#39;s like module:</p>
<pre><span class="kw">module</span><span class="text"> </span><span class="kw2">Util</span><span class="text"> :
  </span><span class="kw1">sig</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">iterative_failure_reason</span><span class="text"> =
      | </span><span class="kw2">Out_of_bounds</span><span class="text"> </span><span class="kw">of</span><span class="text"> </span><span class="kw3">float</span><span class="text">
      | </span><span class="kw2">No_convergence</span><span class="text">
      | </span><span class="kw2">Too_many_iterations</span><span class="text"> </span><span class="kw">of</span><span class="text"> </span><span class="kw3">int</span><span class="text">
      | </span><span class="kw2">Too_few_iterations</span><span class="text"> </span><span class="kw">of</span><span class="text"> </span><span class="kw3">int</span><span class="text">
    </span><span class="kw">exception</span><span class="text"> </span><span class="kw2">Iteration_failure</span><span class="text"> </span><span class="kw">of</span><span class="text"> </span><span class="kw3">string</span><span class="text"> * </span><span class="id">iterative_failure_reason</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">invalidArg</span><span class="text"> : ('</span><span class="id">a</span><span class="text">, </span><span class="kw3">unit</span><span class="text">, </span><span class="kw3">string</span><span class="text">, '</span><span class="id">b</span><span class="text">) </span><span class="id">format4</span><span class="text"> -&gt; '</span><span class="id">a</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">pi</span><span class="text"> : </span><span class="kw3">float</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">midpoint</span><span class="text"> : </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Array</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">dx</span><span class="text"> : </span><span class="kw3">float</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">significantly_different_from</span><span class="text"> : ?</span><span class="id">d</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">bool</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">equal_floats</span><span class="text"> : </span><span class="id">d</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">bool</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">is_nan</span><span class="text"> : </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">bool</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">is_degenerate</span><span class="text"> : </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">bool</span><span class="text">
    </span><span class="kw">type</span><span class="text"> '</span><span class="id">a</span><span class="text"> </span><span class="id">bound</span><span class="text"> = </span><span class="kw2">Open</span><span class="text"> </span><span class="kw">of</span><span class="text"> '</span><span class="id">a</span><span class="text"> | </span><span class="kw2">Closed</span><span class="text"> </span><span class="kw">of</span><span class="text"> '</span><span class="id">a</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">within</span><span class="text"> : '</span><span class="id">a</span><span class="text"> </span><span class="id">bound</span><span class="text"> * '</span><span class="id">a</span><span class="text"> </span><span class="id">bound</span><span class="text"> -&gt; '</span><span class="id">a</span><span class="text"> -&gt; </span><span class="kw3">bool</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Float</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw">type</span><span class="text"> </span><span class="kw2">Optional_arg_intf</span><span class="text"> = </span><span class="kw1">sig</span><span class="text"> </span><span class="kw">type</span><span class="text"> </span><span class="id">opt</span><span class="text"> </span><span class="kw">val</span><span class="text"> </span><span class="id">default</span><span class="text"> : </span><span class="id">opt</span><span class="text"> </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">fst3</span><span class="text"> : '</span><span class="id">a</span><span class="text"> * '</span><span class="id">b</span><span class="text"> * '</span><span class="id">c</span><span class="text"> -&gt; '</span><span class="id">a</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">snd3</span><span class="text"> : '</span><span class="id">a</span><span class="text"> * '</span><span class="id">b</span><span class="text"> * '</span><span class="id">c</span><span class="text"> -&gt; '</span><span class="id">b</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">thr3</span><span class="text"> : '</span><span class="id">a</span><span class="text"> * '</span><span class="id">b</span><span class="text"> * '</span><span class="id">c</span><span class="text"> -&gt; '</span><span class="id">c</span><span class="text">
  </span><span class="kw1">end</span><span class="text">
</span><span class="kw">val</span><span class="text"> </span><span class="kw2">Array</span><span class="text">.</span><span class="id">sumf</span><span class="text"> : </span><span class="kw3">float</span><span class="text"> </span><span class="kw3">array</span><span class="text"> -&gt; </span><span class="kw3">float</span></pre>

</section><section><h3>A quick tour part 2.</h3>

<p><code>Uncategorized</code>: a work in progress</p>
<pre><span class="kw1">#</span><span class="text"> </span><span class="id">show_module</span><span class="text"> </span><span class="kw2">Uncategorized</span><span class="text"> ;;
</span><span class="kw">module</span><span class="text"> </span><span class="kw2">Uncategorized</span><span class="text"> :
  </span><span class="kw1">sig</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Continued_fraction</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Functions</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Lacaml_util</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Svd</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Estimations</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Solvers</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Vectors</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Matrices</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
  </span><span class="kw1">end</span><span class="text">
</span><span class="kw1">#</span><span class="text"> </span><span class="kw">open</span><span class="text"> </span><span class="kw2">Uncategorized</span><span class="text"> ;;
</span><span class="kw1">#</span><span class="text"> </span><span class="kw2">Functions</span><span class="text">.</span><span class="id">regularized_lower_gamma</span><span class="text"> ;;
- : </span><span class="id">a</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> = &lt;</span><span class="kw">fun</span><span class="text">&gt;
</span><span class="kw1">#</span><span class="text"> </span><span class="kw2">Solvers</span><span class="text">.</span><span class="id">newton_raphson_full</span><span class="text"> ;;
- : ?</span><span class="id">init</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">accuracy</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">iterations</span><span class="text">:</span><span class="kw3">int</span><span class="text"> -&gt; </span><span class="id">lower</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">upper</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt;
      </span><span class="kw4">~f</span><span class="text">:(</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text">) -&gt; </span><span class="kw4">~df</span><span class="text">:(</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text">) -&gt; </span><span class="kw3">float</span><span class="text"> = &lt;</span><span class="kw">fun</span><span class="text">&gt;
</span><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="id">show_module</span><span class="text"> </span><span class="kw2">Svd</span><span class="text"> ;;
</span><span class="kw">module</span><span class="text"> </span><span class="kw2">Svd</span><span class="text"> :
</span><span class="kw1">sig</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">t</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">u</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> </span><span class="kw3">array</span><span class="text"> </span><span class="kw3">array</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">s</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> </span><span class="kw3">array</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">vt</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> </span><span class="kw3">array</span><span class="text"> </span><span class="kw3">array</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">svd</span><span class="text"> : ?</span><span class="id">copy</span><span class="text">:</span><span class="kw3">bool</span><span class="text"> -&gt; </span><span class="kw2">Lacaml</span><span class="text">.</span><span class="kw2">D</span><span class="text">.</span><span class="id">mat</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">solve_linear</span><span class="text"> : ?</span><span class="id">lambda</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw2">Lacaml</span><span class="text">.</span><span class="kw2">D</span><span class="text">.</span><span class="id">vec</span><span class="text"> -&gt; </span><span class="kw2">Lacaml</span><span class="text">.</span><span class="kw2">D</span><span class="text">.</span><span class="id">vec</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">covariance_matrix_inv</span><span class="text"> : ?</span><span class="id">lambda</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw2">Lacaml</span><span class="text">.</span><span class="kw2">D</span><span class="text">.</span><span class="id">mat</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">looe</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw2">Lacaml</span><span class="text">.</span><span class="kw2">D</span><span class="text">.</span><span class="id">vec</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw2">Lacaml</span><span class="text">.</span><span class="kw2">D</span><span class="text">.</span><span class="id">vec</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">h</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw2">Lacaml</span><span class="text">.</span><span class="kw2">D</span><span class="text">.</span><span class="id">mat</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">h_diag</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw2">Lacaml</span><span class="text">.</span><span class="kw2">D</span><span class="text">.</span><span class="id">vec</span><span class="text">
  </span><span class="kw1">end</span></pre>

</section><section><h3>A quick tour part 3.</h3>

<p><code>Online</code>: Stable mean and standard deviation for folding over data.</p>
<pre><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="id">show_module</span><span class="text"> </span><span class="kw2">Online</span><span class="text"> ;;
</span><span class="kw">module</span><span class="text"> </span><span class="kw2">Online</span><span class="text"> :
  </span><span class="kw1">sig</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">t</span><span class="text"> = { </span><span class="id">size</span><span class="text"> : </span><span class="kw3">int</span><span class="text">; </span><span class="id">last</span><span class="text"> : </span><span class="kw3">float</span><span class="text">; </span><span class="id">max</span><span class="text"> : </span><span class="kw3">float</span><span class="text">; </span><span class="id">min</span><span class="text"> : </span><span class="kw3">float</span><span class="text">; </span><span class="id">sum</span><span class="text"> : </span><span class="kw3">float</span><span class="text">; </span><span class="id">sum_sq</span><span class="text"> : </span><span class="kw3">float</span><span class="text">; </span><span class="id">mean</span><span class="text"> : </span><span class="kw3">float</span><span class="text">; </span><span class="id">var</span><span class="text"> : </span><span class="kw3">float</span><span class="text">; }
    </span><span class="kw">val</span><span class="text"> </span><span class="id">empty</span><span class="text"> : </span><span class="id">t</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">init</span><span class="text"> : ?</span><span class="id">size</span><span class="text">:</span><span class="kw3">int</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">update</span><span class="text"> = { </span><span class="id">n_mean</span><span class="text"> : </span><span class="kw3">float</span><span class="text">; </span><span class="id">n_var</span><span class="text"> : </span><span class="kw3">float</span><span class="text">; }
    </span><span class="kw">module</span><span class="text"> </span><span class="kw">type</span><span class="text"> </span><span class="kw2">Update_rules</span><span class="text"> =
      </span><span class="kw1">sig</span><span class="text"> </span><span class="kw">val</span><span class="text"> </span><span class="id">apply</span><span class="text"> : </span><span class="id">size</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">n_sum</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">n_sum_sq</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">n_size</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">update</span><span class="text"> </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Make</span><span class="text"> : </span><span class="kw">functor</span><span class="text"> (</span><span class="kw2">Update</span><span class="text"> : </span><span class="kw2">Update_rules</span><span class="text">) -&gt; </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">update</span><span class="text"> : ?</span><span class="id">size</span><span class="text">:</span><span class="kw3">int</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">join</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text">
  </span><span class="kw1">end</span></pre>

<p><code>Unsupervisied</code> : Start of unsupervised methods.</p>
<pre><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="id">show_module</span><span class="text"> </span><span class="kw2">Unsupervised</span><span class="text">.</span><span class="kw2">Pca</span><span class="text"> ;;
</span><span class="kw">module</span><span class="text"> </span><span class="kw2">Pca</span><span class="text"> :
  </span><span class="kw1">sig</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">t</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">variances</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> </span><span class="kw3">array</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">components</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> </span><span class="kw3">array</span><span class="text"> </span><span class="kw3">array</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">scalings</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; (</span><span class="kw3">float</span><span class="text"> * </span><span class="kw3">float</span><span class="text">) </span><span class="kw3">array</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">pca</span><span class="text"> : ?</span><span class="id">demean</span><span class="text">:</span><span class="kw3">bool</span><span class="text"> -&gt; ?</span><span class="id">scale</span><span class="text">:</span><span class="kw3">bool</span><span class="text"> -&gt; ?</span><span class="id">unbiased</span><span class="text">:</span><span class="kw3">bool</span><span class="text"> -&gt; </span><span class="kw2">Lacaml</span><span class="text">.</span><span class="kw2">D</span><span class="text">.</span><span class="id">mat</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">pca_reduction_method</span><span class="text"> = </span><span class="kw2">Num_comp</span><span class="text"> </span><span class="kw">of</span><span class="text"> </span><span class="kw3">int</span><span class="text"> | </span><span class="kw2">Varience_exp</span><span class="text"> </span><span class="kw">of</span><span class="text"> </span><span class="kw3">float</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">reduce</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="id">pca_reduction_method</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text">
  </span><span class="kw1">end</span></pre>

</section><section><h3>A quick tour part 4.</h3>

<p><code>Statistics</code> When you need to get dirty with data</p>
<pre><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="id">show_module</span><span class="text"> </span><span class="kw2">Statistics</span><span class="text"> ;;
</span><span class="kw">module</span><span class="text"> </span><span class="kw2">Statistics</span><span class="text"> :
  </span><span class="kw1">sig</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Descriptive</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Distributions</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Hypothesis_test</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Measures</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Sampling</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
  </span><span class="kw1">end</span><span class="text">
</span><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="text"> </span><span class="kw2">Descriptive</span><span class="text">.</span><span class="id">kurtosis</span><span class="text"> ;;
- : </span><span class="kw3">float</span><span class="text"> </span><span class="kw3">array</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> = &lt;</span><span class="kw">fun</span><span class="text">&gt;
</span><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="text"> </span><span class="kw2">Distributions</span><span class="text">.</span><span class="id">poisson_cdf</span><span class="text"> ;;
- : </span><span class="id">mean</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> = &lt;</span><span class="kw">fun</span><span class="text">&gt;
</span><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="text"> </span><span class="kw2">Hypothesis_test</span><span class="text">.</span><span class="id">mean_t_test</span><span class="text"> ;;
- : </span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw2">Hypothesis_test</span><span class="text">.</span><span class="id">null_hypothesis</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> </span><span class="kw3">array</span><span class="text"> -&gt; </span><span class="kw2">Hypothesis_test</span><span class="text">.</span><span class="id">t</span><span class="text"> = &lt;</span><span class="kw">fun</span><span class="text">&gt;
</span><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="text"> </span><span class="kw2">Sampling</span><span class="text">.</span><span class="id">normal</span><span class="text"> ;;
- : ?</span><span class="id">seed</span><span class="text">:</span><span class="kw3">int</span><span class="text"> </span><span class="kw3">array</span><span class="text"> -&gt; </span><span class="id">mean</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="id">std</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">unit</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> </span><span class="kw2">Sampling</span><span class="text">.</span><span class="id">generator</span><span class="text"> = &lt;</span><span class="kw">fun</span><span class="text">&gt;</span></pre>

</section><section><h3>A quick tour part 5 (not so quick aye?)</h3>

<p><code>Regression</code> Fitting linear model</p>
<pre><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="id">show_module</span><span class="text"> </span><span class="kw2">Regression</span><span class="text"> ;;
</span><span class="kw">module</span><span class="text"> </span><span class="kw2">Regression</span><span class="text"> :
  </span><span class="kw1">sig</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Intf</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">            </span><span class="comment">(* Interfaces constructed by modules below *)</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Univariate</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">SolvedLPViaSvd</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Eval_multivariate</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Multivariate</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Tikhonov</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
  </span><span class="kw1">end</span></pre>

<p><code>Classification</code> : learn probabilistic associations between features and classes</p>
<pre><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="id">show_module</span><span class="text"> </span><span class="kw2">Classification</span><span class="text"> ;;
</span><span class="kw">module</span><span class="text"> </span><span class="kw2">Classification</span><span class="text"> :
  </span><span class="kw1">sig</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Probabilities</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Intf</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">          </span><span class="comment">(* Interfaces constructed by NB and LR *)</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Naive_bayes</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Logistic_regression</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Performance</span><span class="text"> : </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
  </span><span class="kw1">end</span><span class="text">
</span><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="id">show_module</span><span class="text"> </span><span class="kw2">Classification</span><span class="text">.</span><span class="kw2">Logistic_regression</span><span class="text"> ;;
</span><span class="kw">module</span><span class="text"> </span><span class="kw2">Logistic_regression</span><span class="text"> :
  </span><span class="kw1">sig</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Binary</span><span class="text"> : </span><span class="kw">functor</span><span class="text"> (</span><span class="kw2">D</span><span class="text"> : </span><span class="kw2">Intf</span><span class="text">.</span><span class="kw2">Continuous_encoded_data</span><span class="text">) -&gt; </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Multiclass</span><span class="text"> : </span><span class="kw">functor</span><span class="text"> (</span><span class="kw2">D</span><span class="text"> : </span><span class="kw2">Intf</span><span class="text">.</span><span class="kw2">Continuous_encoded_data</span><span class="text">) -&gt; </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
  </span><span class="kw1">end</span><span class="text">
</span><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="id">show_module</span><span class="text"> </span><span class="kw2">Classification</span><span class="text">.</span><span class="kw2">Naive_bayes</span><span class="text"> ;;
</span><span class="kw">module</span><span class="text"> </span><span class="kw2">Naive_bayes</span><span class="text"> :
  </span><span class="kw1">sig</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Binomial</span><span class="text"> : </span><span class="kw">functor</span><span class="text"> (</span><span class="kw2">D</span><span class="text"> : </span><span class="kw2">Intf</span><span class="text">.</span><span class="kw2">Dummy_encoded_data</span><span class="text">) -&gt; </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Categorical</span><span class="text"> : </span><span class="kw">functor</span><span class="text"> (</span><span class="kw2">D</span><span class="text"> : </span><span class="kw2">Intf</span><span class="text">.</span><span class="kw2">Category_encoded_data</span><span class="text">) -&gt; </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
    </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Gaussian</span><span class="text"> : </span><span class="kw">functor</span><span class="text"> (</span><span class="kw2">D</span><span class="text"> : </span><span class="kw2">Intf</span><span class="text">.</span><span class="kw2">Continuous_encoded_data</span><span class="text">) -&gt; </span><span class="kw1">sig</span><span class="text">  </span><span class="kw1">end</span><span class="text">
  </span><span class="kw1">end</span></pre>

</section><section><h3>Demo time: MNIST</h3>

<p>MNIST : <a href='http://yann.lecun.com/exdb/mnist/'>http://yann.lecun.com/exdb/mnist/</a>
Famous data set of handwritten digits collected by NIST and Modified by Yann LeCun,
Corinna Cortes and Christopher J.C. Burges.</p>
<img class="stretch" src="img/mnist.png" alt="MNIST" /></section><section><h3>Demo time: MNIST, approach</h3>

<ul><li class="fragment roll-in">Let&#39;s use Multiclass Logistic Regression.<ul><li class="fragment roll-in">just a minimization of a cost function:</li>
<li class="fragment roll-in"><img src='does_not_exist.png' alt='Insert Equation Here' /></li></ul></li>
<li class="fragment roll-in">Not that kind of conference!</li>
<li class="fragment roll-in">A result of a <code>functor</code>
 <pre><span class="text">  </span><span class="kw1">#</span><span class="text"> </span><span class="kw">open</span><span class="text"> </span><span class="kw2">Classification</span><span class="text">;;
  </span><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="id">show_module_type</span><span class="text"> </span><span class="kw2">Intf</span><span class="text">.</span><span class="kw2">Continuous_encoded_data</span><span class="text"> ;;
  </span><span class="kw">module</span><span class="text"> </span><span class="kw">type</span><span class="text"> </span><span class="kw2">Continuous_encoded_data</span><span class="text"> =
    </span><span class="kw1">sig</span><span class="text">
      </span><span class="kw">type</span><span class="text"> </span><span class="id">clas</span><span class="text">
      </span><span class="kw">type</span><span class="text"> </span><span class="id">feature</span><span class="text">
      </span><span class="kw">val</span><span class="text"> </span><span class="id">encoding</span><span class="text"> : </span><span class="id">feature</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> </span><span class="kw3">array</span><span class="text">
      </span><span class="kw">val</span><span class="text"> </span><span class="id">size</span><span class="text"> : </span><span class="kw3">int</span><span class="text">
    </span><span class="kw1">end</span><span class="text">
  </span><span class="kw1">#</span><span class="text"> </span><span class="kw1">#</span><span class="id">show_module</span><span class="text"> </span><span class="kw2">Logistic_regression</span><span class="text">.</span><span class="kw2">Multiclass</span><span class="text"> ;;
  </span><span class="kw">module</span><span class="text"> </span><span class="kw2">Multiclass</span><span class="text"> :
    </span><span class="kw">functor</span><span class="text"> (</span><span class="kw2">D</span><span class="text"> : </span><span class="kw2">Intf</span><span class="text">.</span><span class="kw2">Continuous_encoded_data</span><span class="text">) -&gt;
      </span><span class="kw1">sig</span><span class="text">
        </span><span class="kw">type</span><span class="text"> </span><span class="id">clas</span><span class="text"> = </span><span class="kw2">D</span><span class="text">.</span><span class="id">clas</span><span class="text">
        </span><span class="kw">type</span><span class="text"> </span><span class="id">feature</span><span class="text"> = </span><span class="kw2">D</span><span class="text">.</span><span class="id">feature</span><span class="text">
        </span><span class="kw">type</span><span class="text"> </span><span class="id">opt</span><span class="text">
        </span><span class="kw">val</span><span class="text"> </span><span class="id">default</span><span class="text"> : </span><span class="id">opt</span><span class="text">
        </span><span class="kw">type</span><span class="text"> </span><span class="id">t</span><span class="text">
        </span><span class="kw">val</span><span class="text"> </span><span class="id">eval</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="id">feature</span><span class="text"> -&gt; </span><span class="id">clas</span><span class="text"> </span><span class="kw2">Probabilities</span><span class="text">.</span><span class="id">t</span><span class="text">
        </span><span class="kw">type</span><span class="text"> </span><span class="id">samples</span><span class="text"> = (</span><span class="id">clas</span><span class="text"> * </span><span class="id">feature</span><span class="text">) </span><span class="kw3">list</span><span class="text">
        </span><span class="kw">val</span><span class="text"> </span><span class="id">estimate</span><span class="text"> : ?</span><span class="id">opt</span><span class="text">:</span><span class="id">opt</span><span class="text"> -&gt; ?</span><span class="id">classes</span><span class="text">:</span><span class="id">clas</span><span class="text"> </span><span class="kw3">list</span><span class="text"> -&gt;
                        </span><span class="id">samples</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text">
        </span><span class="kw">val</span><span class="text"> </span><span class="id">opt</span><span class="text"> : ?</span><span class="id">lambda</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; ?</span><span class="id">tolerance</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt;
                    </span><span class="kw3">unit</span><span class="text"> -&gt; </span><span class="id">opt</span><span class="text">
        </span><span class="kw">val</span><span class="text"> </span><span class="id">coefficients</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> </span><span class="kw3">array</span><span class="text"> </span><span class="kw3">array</span><span class="text">
        </span><span class="kw">val</span><span class="text"> </span><span class="id">class_order</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="id">clas</span><span class="text"> </span><span class="kw3">list</span><span class="text">
      </span><span class="kw1">end</span><span class="text">
  </span></pre></li></ul>

</section><section><h3>Demo time: MNIST. load the data</h3>

<p><a href='https://github.com/hammerlab/oml/blob/master/src/scripts/mnist_test.ml'>src/scripts/mnist_test.ml</a></p>
<pre><span class="directive">#require</span><span class="text"> </span><span class="string">"dsfo"</span><span class="text"> ;;
</span><span class="kw2">Mnist</span><span class="text">.</span><span class="id">download</span><span class="text"> `</span><span class="kw2">Train</span><span class="text"> ;;
</span><span class="kw2">Mnist</span><span class="text">.</span><span class="id">download</span><span class="text"> `</span><span class="kw2">Test</span><span class="text"> ;;
</span><span class="kw">let</span><span class="text"> </span><span class="id">m_train</span><span class="text"> = </span><span class="kw2">Mnist</span><span class="text">.</span><span class="id">data</span><span class="text"> `</span><span class="kw2">Train</span><span class="text"> ;;
</span><span class="kw">let</span><span class="text"> </span><span class="id">m_test</span><span class="text"> = </span><span class="kw2">Mnist</span><span class="text">.</span><span class="id">data</span><span class="text"> `</span><span class="kw2">Test</span><span class="text"> ;;
</span><span class="kw">val</span><span class="text"> </span><span class="id">m_train</span><span class="text"> : (</span><span class="kw3">float</span><span class="text">, </span><span class="kw2">Bigarrayo</span><span class="text">.</span><span class="id">float64_elt</span><span class="text">, </span><span class="kw2">Bigarrayo</span><span class="text">.</span><span class="id">fortran_layout</span><span class="text">) </span><span class="kw2">Bigarrayo</span><span class="text">.</span><span class="kw2">A2</span><span class="text">.</span><span class="id">t</span><span class="text"> =
        </span><span class="kw2">C1</span><span class="text">  </span><span class="kw2">C2</span><span class="text">  </span><span class="kw2">C3</span><span class="text">     </span><span class="kw2">C59998</span><span class="text"> </span><span class="kw2">C59999</span><span class="text"> </span><span class="kw2">C60000</span><span class="text">
    </span><span class="kw2">R1</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> ...      </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">
    </span><span class="kw2">R2</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> ...      </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">
    </span><span class="kw2">R3</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> ...      </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">
       ... ... ... ...    ...    ...    ...
  </span><span class="kw2">R792</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> ...      </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">
  </span><span class="kw2">R793</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> ...      </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">1</span><span class="text">
  </span><span class="kw2">R794</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> ...      </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">
</span><span class="kw">val</span><span class="text"> </span><span class="id">m_test</span><span class="text"> : (</span><span class="kw3">float</span><span class="text">, </span><span class="kw2">Bigarrayo</span><span class="text">.</span><span class="id">float64_elt</span><span class="text">, </span><span class="kw2">Bigarrayo</span><span class="text">.</span><span class="id">fortran_layout</span><span class="text">) </span><span class="kw2">Bigarrayo</span><span class="text">.</span><span class="kw2">A2</span><span class="text">.</span><span class="id">t</span><span class="text"> =
        </span><span class="kw2">C1</span><span class="text">  </span><span class="kw2">C2</span><span class="text">  </span><span class="kw2">C3</span><span class="text">     </span><span class="kw2">C9998</span><span class="text"> </span><span class="kw2">C9999</span><span class="text"> </span><span class="kw2">C10000</span><span class="text">
    </span><span class="kw2">R1</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> ...     </span><span class="numeric">0</span><span class="text">     </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">
    </span><span class="kw2">R2</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> ...     </span><span class="numeric">0</span><span class="text">     </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">
    </span><span class="kw2">R3</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> ...     </span><span class="numeric">0</span><span class="text">     </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">
       ... ... ... ...   ...   ...    ...
  </span><span class="kw2">R792</span><span class="text">   </span><span class="numeric">1</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> ...     </span><span class="numeric">0</span><span class="text">     </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">
  </span><span class="kw2">R793</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> ...     </span><span class="numeric">0</span><span class="text">     </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span><span class="text">
  </span><span class="kw2">R794</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> ...     </span><span class="numeric">0</span><span class="text">     </span><span class="numeric">0</span><span class="text">      </span><span class="numeric">0</span></pre>

</section><section><h3>Demo time: MNIST, visualize</h3>

<pre><span class="kw1">#</span><span class="text"> </span><span class="id">showme</span><span class="text"> </span><span class="numeric">12312</span><span class="text"> ;;
- : (</span><span class="kw3">int</span><span class="text">, </span><span class="kw2">Bigarrayo</span><span class="text">.</span><span class="id">int8_unsigned_elt</span><span class="text">, </span><span class="kw2">Bigarrayo</span><span class="text">.</span><span class="id">fortran_layout</span><span class="text">) </span><span class="kw2">Bigarrayo</span><span class="text">.</span><span class="kw2">GA</span><span class="text">.</span><span class="id">t</span><span class="text"> * </span><span class="kw3">int</span><span class="text"> =
(    </span><span class="kw2">C1</span><span class="text"> </span><span class="kw2">C2</span><span class="text"> </span><span class="kw2">C3</span><span class="text"> </span><span class="kw2">C4</span><span class="text">  </span><span class="kw2">C5</span><span class="text">  </span><span class="kw2">C6</span><span class="text">  </span><span class="kw2">C7</span><span class="text">  </span><span class="kw2">C8</span><span class="text">  </span><span class="kw2">C9</span><span class="text"> </span><span class="kw2">C10</span><span class="text"> </span><span class="kw2">C11</span><span class="text"> </span><span class="kw2">C12</span><span class="text"> </span><span class="kw2">C13</span><span class="text"> </span><span class="kw2">C14</span><span class="text"> </span><span class="kw2">C15</span><span class="text"> </span><span class="kw2">C16</span><span class="text"> </span><span class="kw2">C17</span><span class="text"> </span><span class="kw2">C18</span><span class="text"> </span><span class="kw2">C19</span><span class="text"> </span><span class="kw2">C20</span><span class="text"> </span><span class="kw2">C21</span><span class="text"> </span><span class="kw2">C22</span><span class="text"> </span><span class="kw2">C23</span><span class="text"> </span><span class="kw2">C24</span><span class="text"> </span><span class="kw2">C25</span><span class="text"> </span><span class="kw2">C26</span><span class="text"> </span><span class="kw2">C27</span><span class="text"> </span><span class="kw2">C28</span><span class="text">
  </span><span class="kw2">R1</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
  </span><span class="kw2">R2</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
  </span><span class="kw2">R3</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
  </span><span class="kw2">R4</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
  </span><span class="kw2">R5</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
  </span><span class="kw2">R6</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> </span><span class="numeric">108</span><span class="text"> </span><span class="numeric">235</span><span class="text"> </span><span class="numeric">241</span><span class="text"> </span><span class="numeric">241</span><span class="text"> </span><span class="numeric">241</span><span class="text"> </span><span class="numeric">120</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
  </span><span class="kw2">R7</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">15</span><span class="text"> </span><span class="numeric">109</span><span class="text"> </span><span class="numeric">228</span><span class="text"> </span><span class="numeric">228</span><span class="text"> </span><span class="numeric">255</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">248</span><span class="text"> </span><span class="numeric">121</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
  </span><span class="kw2">R8</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">22</span><span class="text">  </span><span class="numeric">81</span><span class="text"> </span><span class="numeric">179</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">254</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">213</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
  </span><span class="kw2">R9</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">22</span><span class="text"> </span><span class="numeric">187</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">218</span><span class="text"> </span><span class="numeric">187</span><span class="text"> </span><span class="numeric">186</span><span class="text"> </span><span class="numeric">186</span><span class="text"> </span><span class="numeric">243</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">213</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R10</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> </span><span class="numeric">179</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">247</span><span class="text"> </span><span class="numeric">192</span><span class="text">  </span><span class="numeric">31</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> </span><span class="numeric">116</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">213</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R11</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> </span><span class="numeric">214</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">226</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> </span><span class="numeric">172</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">213</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R12</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">79</span><span class="text"> </span><span class="numeric">128</span><span class="text"> </span><span class="numeric">198</span><span class="text">  </span><span class="numeric">93</span><span class="text">  </span><span class="numeric">83</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">10</span><span class="text"> </span><span class="numeric">218</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">213</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R13</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> </span><span class="numeric">102</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">135</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R14</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> </span><span class="numeric">228</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">225</span><span class="text">  </span><span class="numeric">38</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R15</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> </span><span class="numeric">242</span><span class="text"> </span><span class="numeric">254</span><span class="text"> </span><span class="numeric">254</span><span class="text"> </span><span class="numeric">254</span><span class="text"> </span><span class="numeric">137</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R16</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> </span><span class="numeric">171</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">216</span><span class="text"> </span><span class="numeric">108</span><span class="text"> </span><span class="numeric">108</span><span class="text">  </span><span class="numeric">45</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R17</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">10</span><span class="text">  </span><span class="numeric">94</span><span class="text"> </span><span class="numeric">164</span><span class="text"> </span><span class="numeric">254</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">231</span><span class="text">  </span><span class="numeric">45</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R18</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">22</span><span class="text">  </span><span class="numeric">81</span><span class="text"> </span><span class="numeric">172</span><span class="text"> </span><span class="numeric">218</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">254</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">162</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R19</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">61</span><span class="text"> </span><span class="numeric">110</span><span class="text"> </span><span class="numeric">215</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">254</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">218</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R20</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text"> </span><span class="numeric">108</span><span class="text"> </span><span class="numeric">247</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">229</span><span class="text"> </span><span class="numeric">143</span><span class="text">  </span><span class="numeric">66</span><span class="text">  </span><span class="numeric">66</span><span class="text">  </span><span class="numeric">66</span><span class="text">  </span><span class="numeric">66</span><span class="text">  </span><span class="numeric">66</span><span class="text">  </span><span class="numeric">66</span><span class="text">  </span><span class="numeric">66</span><span class="text">  </span><span class="numeric">31</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R21</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">20</span><span class="text"> </span><span class="numeric">243</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">251</span><span class="text"> </span><span class="numeric">142</span><span class="text">  </span><span class="numeric">42</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R22</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text"> </span><span class="numeric">206</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">253</span><span class="text"> </span><span class="numeric">235</span><span class="text"> </span><span class="numeric">212</span><span class="text">  </span><span class="numeric">88</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R23</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text"> </span><span class="numeric">170</span><span class="text"> </span><span class="numeric">240</span><span class="text"> </span><span class="numeric">240</span><span class="text"> </span><span class="numeric">240</span><span class="text"> </span><span class="numeric">240</span><span class="text"> </span><span class="numeric">140</span><span class="text">  </span><span class="numeric">34</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R24</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R25</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R26</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R27</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">
 </span><span class="kw2">R28</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">  </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">   </span><span class="numeric">0</span><span class="text">, </span><span class="numeric">2</span><span class="text">)</span></pre>

</section><section><h3>Demo time: MNIST, encode the data:</h3>

<pre><span class="kw">let</span><span class="text"> </span><span class="id">feature_size</span><span class="text"> = </span><span class="numeric">28</span><span class="text"> * </span><span class="numeric">28</span><span class="text">
</span><span class="kw">module</span><span class="text"> </span><span class="kw2">MnistEncoded</span><span class="text"> =
  </span><span class="kw1">struct</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">clas</span><span class="text"> = </span><span class="kw3">int</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">feature</span><span class="text"> = </span><span class="kw3">float</span><span class="text"> </span><span class="kw3">array</span><span class="text">
    </span><span class="kw">let</span><span class="text"> </span><span class="id">encoding</span><span class="text"> </span><span class="id">arr</span><span class="text"> = </span><span class="id">arr</span><span class="text">
    </span><span class="kw">let</span><span class="text"> </span><span class="id">size</span><span class="text"> = </span><span class="id">feature_size</span><span class="text">
  </span><span class="kw1">end</span><span class="text">
;;</span></pre>

</section><section><h3>Demo time: MNIST, plumbing</h3>

<pre><span class="kw">let</span><span class="text"> </span><span class="id">column_to_label</span><span class="text"> </span><span class="id">c</span><span class="text"> =
  </span><span class="kw">let</span><span class="text"> </span><span class="kw">rec</span><span class="text"> </span><span class="id">loop</span><span class="text"> </span><span class="id">i</span><span class="text"> =
    </span><span class="kw1">if</span><span class="text"> </span><span class="id">c</span><span class="text">.{</span><span class="id">i</span><span class="text"> + </span><span class="id">feature_size</span><span class="text">} = </span><span class="numeric">1.0</span><span class="text"> </span><span class="kw1">then</span><span class="text"> </span><span class="id">i</span><span class="text">
    </span><span class="kw1">else</span><span class="text"> </span><span class="id">loop</span><span class="text"> (</span><span class="id">i</span><span class="text"> + </span><span class="numeric">1</span><span class="text">) </span><span class="kw">in</span><span class="text">
  </span><span class="id">loop</span><span class="text"> </span><span class="numeric">1</span><span class="text">

</span><span class="kw">let</span><span class="text"> </span><span class="id">to_samples</span><span class="text"> </span><span class="id">data</span><span class="text"> =
  </span><span class="kw2">Array</span><span class="text">.</span><span class="id">init</span><span class="text"> (</span><span class="kw2">Mat</span><span class="text">.</span><span class="id">dim2</span><span class="text"> </span><span class="id">data</span><span class="text">) (</span><span class="kw">fun</span><span class="text"> </span><span class="id">i</span><span class="text"> -&gt;
    </span><span class="kw">let</span><span class="text"> </span><span class="id">col</span><span class="text"> = </span><span class="kw2">Mat</span><span class="text">.</span><span class="id">col</span><span class="text"> </span><span class="id">data</span><span class="text"> (</span><span class="id">i</span><span class="text"> + </span><span class="numeric">1</span><span class="text">) </span><span class="kw">in</span><span class="text">
    </span><span class="kw">let</span><span class="text"> </span><span class="id">ftr</span><span class="text"> = </span><span class="id">copy</span><span class="text"> </span><span class="kw4">~n</span><span class="text">:</span><span class="kw2">MnistEncoded</span><span class="text">.</span><span class="id">size</span><span class="text"> </span><span class="id">col</span><span class="text"> |&gt; </span><span class="kw2">Vec</span><span class="text">.</span><span class="id">to_array</span><span class="text"> </span><span class="kw">in</span><span class="text">
    </span><span class="kw">let</span><span class="text"> </span><span class="id">lab</span><span class="text"> = </span><span class="id">column_to_label</span><span class="text"> </span><span class="id">col</span><span class="text"> </span><span class="kw">in</span><span class="text">
    </span><span class="id">lab</span><span class="text">, </span><span class="id">ftr</span><span class="text">)
  |&gt; </span><span class="kw2">Array</span><span class="text">.</span><span class="id">to_list</span><span class="text">

</span><span class="kw">let</span><span class="text"> </span><span class="id">s_train</span><span class="text"> = </span><span class="id">to_samples</span><span class="text"> </span><span class="id">m_train</span><span class="text">
</span><span class="kw">let</span><span class="text"> </span><span class="id">s_test</span><span class="text"> = </span><span class="id">to_samples</span><span class="text"> </span><span class="id">m_test</span><span class="text">

</span><span class="kw">let</span><span class="text"> </span><span class="id">tolerance</span><span class="text"> =
  </span><span class="kw1">if</span><span class="text"> </span><span class="id">not</span><span class="text"> (!</span><span class="kw2">Sys</span><span class="text">.</span><span class="id">interactive</span><span class="text">) &amp;&amp; </span><span class="kw2">Array</span><span class="text">.</span><span class="id">length</span><span class="text"> </span><span class="kw2">Sys</span><span class="text">.</span><span class="id">argv</span><span class="text"> = </span><span class="numeric">2</span><span class="text"> </span><span class="kw1">then</span><span class="text">
    </span><span class="id">float_of_string</span><span class="text"> </span><span class="kw2">Sys</span><span class="text">.</span><span class="id">argv</span><span class="text">.(</span><span class="numeric">1</span><span class="text">)
  </span><span class="kw1">else</span><span class="text">
    </span><span class="numeric">1e7</span></pre>

</section><section><h3>Demo time: MNIST, apply the functor and train</h3>

<pre><span class="kw1">#</span><span class="text"> </span><span class="kw">module</span><span class="text"> </span><span class="kw2">MnistLr</span><span class="text"> = </span><span class="kw2">Logistic_regression</span><span class="text">.</span><span class="kw2">Multiclass</span><span class="text">(</span><span class="kw2">MnistEncoded</span><span class="text">) ;;
</span><span class="kw">module</span><span class="text"> </span><span class="kw2">MnistLr</span><span class="text"> :
  </span><span class="kw1">sig</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">clas</span><span class="text"> = </span><span class="kw2">MnistEncoded</span><span class="text">.</span><span class="id">clas</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">feature</span><span class="text"> = </span><span class="kw2">MnistEncoded</span><span class="text">.</span><span class="id">feature</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">opt</span><span class="text"> = </span><span class="kw2">Logistic_regression</span><span class="text">.</span><span class="kw2">Multiclass</span><span class="text">(</span><span class="kw2">MnistEncoded</span><span class="text">).</span><span class="id">opt</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">default</span><span class="text"> : </span><span class="id">opt</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">t</span><span class="text"> = </span><span class="kw2">Logistic_regression</span><span class="text">.</span><span class="kw2">Multiclass</span><span class="text">(</span><span class="kw2">MnistEncoded</span><span class="text">).</span><span class="id">t</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">eval</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="id">feature</span><span class="text"> -&gt; </span><span class="id">clas</span><span class="text"> </span><span class="kw2">Probabilities</span><span class="text">.</span><span class="id">t</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">samples</span><span class="text"> = (</span><span class="id">clas</span><span class="text"> * </span><span class="id">feature</span><span class="text">) </span><span class="kw3">list</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">estimate</span><span class="text"> : ?</span><span class="id">opt</span><span class="text">:</span><span class="id">opt</span><span class="text"> -&gt; ?</span><span class="id">classes</span><span class="text">:</span><span class="id">clas</span><span class="text"> </span><span class="kw3">list</span><span class="text"> -&gt; </span><span class="id">samples</span><span class="text"> -&gt; </span><span class="id">t</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">opt</span><span class="text"> : ?</span><span class="id">lambda</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; ?</span><span class="id">tolerance</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; </span><span class="kw3">unit</span><span class="text"> -&gt; </span><span class="id">opt</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">coefficients</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text"> </span><span class="kw3">array</span><span class="text"> </span><span class="kw3">array</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">class_order</span><span class="text"> : </span><span class="id">t</span><span class="text"> -&gt; </span><span class="id">clas</span><span class="text"> </span><span class="kw3">list</span><span class="text">
  </span><span class="kw1">end</span><span class="text">
</span><span class="kw1">#</span><span class="text"> </span><span class="kw">let</span><span class="text"> </span><span class="id">mnist_lr</span><span class="text"> = </span><span class="kw2">MnistLr</span><span class="text">.(</span><span class="id">estimate</span><span class="text"> </span><span class="kw4">~opt</span><span class="text">:(</span><span class="id">opt</span><span class="text"> </span><span class="kw4">~tolerance</span><span class="text"> ()) </span><span class="id">s_train</span><span class="text">)</span></pre>

</section><section><h3>Demo time: MNIST, evaluate on test data</h3>

<pre><span class="kw1">#</span><span class="text"> </span><span class="kw">let</span><span class="text"> </span><span class="id">perf_test</span><span class="text"> =
    </span><span class="id">s_test</span><span class="text">
    |&gt; </span><span class="kw2">List</span><span class="text">.</span><span class="id">map</span><span class="text"> (</span><span class="kw">fun</span><span class="text"> (</span><span class="id">c</span><span class="text">, </span><span class="id">f</span><span class="text">) -&gt; </span><span class="id">c</span><span class="text">, </span><span class="kw2">P</span><span class="text">.</span><span class="id">most_likely</span><span class="text"> (</span><span class="kw2">MnistLr</span><span class="text">.</span><span class="id">eval</span><span class="text"> </span><span class="id">mnist_lr</span><span class="text"> </span><span class="id">f</span><span class="text">)) ;;
</span><span class="kw">val</span><span class="text"> </span><span class="id">perf_test</span><span class="text"> : (</span><span class="kw3">int</span><span class="text"> * </span><span class="kw2">MnistLr</span><span class="text">.</span><span class="id">clas</span><span class="text">) </span><span class="kw3">list</span><span class="text"> =
[(</span><span class="numeric">8</span><span class="text">, </span><span class="numeric">8</span><span class="text">); (</span><span class="numeric">3</span><span class="text">, </span><span class="numeric">3</span><span class="text">); (</span><span class="numeric">2</span><span class="text">, </span><span class="numeric">2</span><span class="text">); (</span><span class="numeric">1</span><span class="text">, </span><span class="numeric">1</span><span class="text">); (</span><span class="numeric">5</span><span class="text">, </span><span class="numeric">5</span><span class="text">); (</span><span class="numeric">2</span><span class="text">, </span><span class="numeric">2</span><span class="text">); (</span><span class="numeric">5</span><span class="text">, </span><span class="numeric">5</span><span class="text">); (</span><span class="numeric">10</span><span class="text">, </span><span class="numeric">10</span><span class="text">); ...]

</span><span class="kw1">#</span><span class="text"> </span><span class="kw">let</span><span class="text"> </span><span class="id">correct_test</span><span class="text"> =
    </span><span class="kw2">List</span><span class="text">.</span><span class="id">fold_left</span><span class="text"> (</span><span class="kw">fun</span><span class="text"> </span><span class="id">c</span><span class="text"> (</span><span class="id">a</span><span class="text">,</span><span class="id">p</span><span class="text">) -&gt; </span><span class="kw1">if</span><span class="text"> </span><span class="id">a</span><span class="text"> = </span><span class="id">p</span><span class="text"> </span><span class="kw1">then</span><span class="text"> </span><span class="id">c</span><span class="text"> + </span><span class="numeric">1</span><span class="text"> </span><span class="kw1">else</span><span class="text"> </span><span class="id">c</span><span class="text">) </span><span class="numeric">0</span><span class="text"> </span><span class="id">perf_test</span><span class="text">;;
</span><span class="kw">val</span><span class="text"> </span><span class="id">correct_test</span><span class="text"> : </span><span class="kw3">int</span><span class="text"> = </span><span class="numeric">9263</span><span class="text">

</span><span class="kw1">#</span><span class="text"> </span><span class="kw">let</span><span class="text"> </span><span class="id">total_test</span><span class="text"> = </span><span class="kw2">List</span><span class="text">.</span><span class="id">length</span><span class="text"> </span><span class="id">perf_test</span><span class="text">;;
</span><span class="kw">val</span><span class="text"> </span><span class="id">total_test</span><span class="text"> : </span><span class="kw3">int</span><span class="text"> = </span><span class="numeric">10000</span><span class="text">

</span><span class="kw1">#</span><span class="text"> </span><span class="kw2">Printf</span><span class="text">.</span><span class="id">printf</span><span class="text"> </span><span class="string">"test %0.3f correct\n"</span><span class="text"> ((</span><span class="kw3">float</span><span class="text"> </span><span class="id">correct_test</span><span class="text">) /. (</span><span class="kw3">float</span><span class="text"> </span><span class="id">total_test</span><span class="text">));;
</span><span class="id">test</span><span class="text"> </span><span class="numeric">0.926</span><span class="text"> </span><span class="id">correct</span><span class="text">         </span></pre>

</section><section><h3>Three Lessons for OCaml: 1.</h3>

<p><code>local open</code> &amp; <code>overloading</code> = <em>cheap DSL</em></p>
<pre><span class="kw">let</span><span class="text"> </span><span class="id">circle_area</span><span class="text"> </span><span class="id">r</span><span class="text"> = </span><span class="kw2">Float</span><span class="text">.(</span><span class="id">pi</span><span class="text"> * </span><span class="id">r</span><span class="text"> * </span><span class="id">r</span><span class="text">)
</span><span class="kw">let</span><span class="text"> </span><span class="id">norm</span><span class="text"> </span><span class="id">x</span><span class="text"> = </span><span class="id">sqrt</span><span class="text"> </span><span class="kw2">Vector</span><span class="text">.(</span><span class="id">x</span><span class="text">**`</span><span class="kw2">T</span><span class="text"> * </span><span class="id">x</span><span class="text">)</span></pre>

</section><section><h3>Three Lessons for OCaml: 2.</h3>

<p>Separate optional arguments into a separate type:</p>
<pre><span class="kw">module</span><span class="text"> </span><span class="kw2">Capability</span><span class="text"> :
  </span><span class="kw1">sig</span><span class="text">
    </span><span class="kw">type</span><span class="text"> </span><span class="id">optional_args</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">opt</span><span class="text"> : ?</span><span class="id">foo</span><span class="text">:</span><span class="kw3">float</span><span class="text"> -&gt; ?</span><span class="id">bar</span><span class="text">:[`</span><span class="kw2">Whatever</span><span class="text"> | `</span><span class="kw2">Something</span><span class="text"> ] -&gt; </span><span class="kw3">unit</span><span class="text"> -&gt; </span><span class="id">optional_args</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">default</span><span class="text"> : </span><span class="id">optional_args</span><span class="text">                </span><span class="comment">(* let default = opt () *)</span><span class="text">
    </span><span class="kw">val</span><span class="text"> </span><span class="id">work</span><span class="text"> : ?</span><span class="id">o</span><span class="text">:</span><span class="id">optional_args</span><span class="text"> -&gt; [`</span><span class="kw2">Other</span><span class="text"> | `</span><span class="kw2">Required</span><span class="text"> | `</span><span class="kw2">Args</span><span class="text"> ] -&gt; </span><span class="kw3">int</span><span class="text">
  </span><span class="kw1">end</span></pre>

</section><section><h3>Three Lessons for OCaml: 3 ~ kind of.</h3>

<ul><li>Cheating heuristic: to write fast OCaml, write &quot;C&quot;-Caml.</li><li>Pretend that you&#39;re writing <code>C</code> (unroll).</li></ul>

<pre><span class="kw">let</span><span class="text"> </span><span class="id">sum1</span><span class="text"> </span><span class="id">arr</span><span class="text"> = </span><span class="kw2">Kahan</span><span class="text">.</span><span class="id">sum</span><span class="text"> (</span><span class="kw2">Array</span><span class="text">.</span><span class="id">fold_left</span><span class="text"> </span><span class="kw2">Kahan</span><span class="text">.</span><span class="id">update</span><span class="text"> </span><span class="kw2">Kahan</span><span class="text">.</span><span class="id">empty</span><span class="text"> </span><span class="id">a</span><span class="text">)
</span><span class="kw">let</span><span class="text"> </span><span class="id">sum2</span><span class="text"> </span><span class="id">arr</span><span class="text"> =
  </span><span class="kw">let</span><span class="text"> </span><span class="id">c</span><span class="text"> = </span><span class="kw1">ref</span><span class="text"> </span><span class="numeric">0</span><span class="text">. </span><span class="kw">in</span><span class="text">
  </span><span class="kw">let</span><span class="text"> </span><span class="id">s</span><span class="text"> = </span><span class="kw1">ref</span><span class="text"> </span><span class="numeric">0</span><span class="text">. </span><span class="kw">in</span><span class="text">
  </span><span class="kw1">for</span><span class="text"> </span><span class="id">i</span><span class="text"> = </span><span class="numeric">0</span><span class="text"> </span><span class="kw1">to</span><span class="text"> </span><span class="kw2">Array</span><span class="text">.</span><span class="id">length</span><span class="text"> </span><span class="id">a</span><span class="text"> - </span><span class="numeric">1</span><span class="text"> </span><span class="kw1">do</span><span class="text">
    </span><span class="kw">let</span><span class="text"> </span><span class="id">x</span><span class="text"> = </span><span class="id">a</span><span class="text">.(</span><span class="id">i</span><span class="text">) -. !</span><span class="id">c</span><span class="text"> </span><span class="kw">in</span><span class="text">
    </span><span class="kw">let</span><span class="text"> </span><span class="id">ns</span><span class="text"> = !</span><span class="id">s</span><span class="text"> +. </span><span class="id">x</span><span class="text"> </span><span class="kw">in</span><span class="text">
    </span><span class="id">c</span><span class="text"> := (</span><span class="id">ns</span><span class="text"> -. !</span><span class="id">s</span><span class="text">) -. </span><span class="id">x</span><span class="text">;
    </span><span class="id">s</span><span class="text"> := </span><span class="id">ns</span><span class="text">;
  </span><span class="kw1">done</span><span class="text">;
  !</span><span class="id">s</span></pre>

</section><section><h3>Three Reasons to use types in ML: Problem Domain</h3>

<pre><span class="kw">type</span><span class="text"> </span><span class="id">amino_acid</span><span class="text"> =
  | </span><span class="kw2">A</span><span class="text"> | </span><span class="kw2">C</span><span class="text"> | </span><span class="kw2">D</span><span class="text"> | </span><span class="kw2">E</span><span class="text"> | </span><span class="kw2">F</span><span class="text"> | </span><span class="kw2">G</span><span class="text"> | </span><span class="kw2">H</span><span class="text"> | </span><span class="kw2">I</span><span class="text"> | </span><span class="kw2">K</span><span class="text"> | </span><span class="kw2">L</span><span class="text">
  | </span><span class="kw2">M</span><span class="text"> | </span><span class="kw2">N</span><span class="text"> | </span><span class="kw2">P</span><span class="text"> | </span><span class="kw2">Q</span><span class="text"> | </span><span class="kw2">R</span><span class="text"> | </span><span class="kw2">S</span><span class="text"> | </span><span class="kw2">T</span><span class="text"> | </span><span class="kw2">V</span><span class="text"> | </span><span class="kw2">W</span><span class="text"> | </span><span class="kw2">Y</span><span class="text">

</span><span class="kw">type</span><span class="text"> </span><span class="id">bs</span><span class="text"> =
  | </span><span class="kw2">Binder</span><span class="text">
  | </span><span class="kw2">NonBinder</span><span class="text">

</span><span class="kw">type</span><span class="text"> </span><span class="id">ord</span><span class="text"> = </span><span class="kw2">Eq</span><span class="text"> | </span><span class="kw2">Lt</span><span class="text"> | </span><span class="kw2">Gt</span><span class="text">

</span><span class="kw">type</span><span class="text"> </span><span class="id">transforms</span><span class="text"> =
  | </span><span class="kw2">NoOp</span><span class="text">
  | </span><span class="kw2">Log</span><span class="text">                 </span><span class="comment">(* natural logarithm *)</span><span class="text">
  | </span><span class="kw2">Nielson</span><span class="text"> </span><span class="kw">of</span><span class="text"> </span><span class="kw3">float</span><span class="text">    </span><span class="comment">(* max 0 (1.0 - log b / log cap *)</span><span class="text">
  | </span><span class="kw2">NielCon</span><span class="text"> </span><span class="kw">of</span><span class="text"> </span><span class="kw3">float</span></pre>

</section><section><h3>Three Reasons to use types in ML: Specificity</h3>

<ul><li><p>We can be precise</p>
</li><li><p>Yes, a <em>statistician</em> knows how to use <code>R</code> and <code>scipy</code> but would a non-expert know?
 For example: Suppress the intercept in regression in R:</p>
</li></ul>

<pre class="terminal">model &lt;- fit(y ~ 0 + x1 + x2, data = bar)
model &lt;- glm(y ~ x1 + x2 - 1, data = bar)</span></code></pre>

<p>or Oml</p>
<pre class="terminal"># Rm.(regress ~opt:(opt ~add_constant_column:false ())) ;;
Rm.input array -&gt; resp:float array -&gt; Rm.t = &lt;fun&gt;</span></code></pre>

</section><section><h3>Three Reasons to use types in ML: Typeful transformations</h3>

<ul><li class="fragment roll-in">regression, classification (... other methods) aren&#39;t <em>objects</em>:<ul><li class="fragment roll-in"><strong>Functors</strong>. Typeful transformations.</li></ul></li>
<li class="fragment roll-in">Step 1.<ul><li><code>val linear_regress : float array -&gt; float array -&gt; float</code></li><li><code>val classifier : (clas * feature) list -&gt; (feature -&gt; clas Probabilities.t)</code></li><li>Really step 0.1</li></ul></li>
<li class="fragment roll-in">Step 2. Dependent types?<ul><li>Normally distributed errors.</li><li>Data bounded to specific ranges.</li></ul></li></ul>

</section><section><h3>Three Reasons to use types in ML: 4a.</h3>

<p>Types can solve &quot;META&quot; problems:
ex. Training vs Validation vs Testing</p>
<pre><span class="comment">(* type of data *)</span><span class="text">
</span><span class="kw">type</span><span class="text"> </span><span class="id">training</span><span class="text">
</span><span class="kw">type</span><span class="text"> </span><span class="id">validating</span><span class="text">
</span><span class="kw">type</span><span class="text"> </span><span class="id">testing</span><span class="text">

</span><span class="comment">(* type of models *)</span><span class="text">
</span><span class="kw">type</span><span class="text"> </span><span class="id">trained</span><span class="text">
</span><span class="kw">type</span><span class="text"> </span><span class="id">validated</span><span class="text">

</span><span class="kw">module</span><span class="text"> </span><span class="kw">type</span><span class="text"> </span><span class="kw2">Machine_learning_pipeline</span><span class="text"> = </span><span class="kw1">sig</span><span class="text">
  </span><span class="kw">type</span><span class="text"> '</span><span class="id">a</span><span class="text"> </span><span class="id">t</span><span class="text">
  </span><span class="kw">type</span><span class="text"> '</span><span class="id">a</span><span class="text"> </span><span class="id">data</span><span class="text">
  </span><span class="kw">val</span><span class="text"> </span><span class="id">train</span><span class="text"> : </span><span class="id">training</span><span class="text"> </span><span class="id">data</span><span class="text"> -&gt; </span><span class="id">trained</span><span class="text"> </span><span class="id">t</span><span class="text">
  </span><span class="kw">val</span><span class="text"> </span><span class="id">validate</span><span class="text"> : </span><span class="id">validating</span><span class="text"> </span><span class="id">data</span><span class="text"> -&gt; </span><span class="id">trained</span><span class="text"> </span><span class="id">t</span><span class="text"> -&gt; </span><span class="id">validated</span><span class="text"> </span><span class="id">t</span><span class="text">
  </span><span class="kw">val</span><span class="text"> </span><span class="id">test</span><span class="text"> : </span><span class="id">testing</span><span class="text"> </span><span class="id">data</span><span class="text"> -&gt; </span><span class="id">validated</span><span class="text"> </span><span class="id">t</span><span class="text"> -&gt; </span><span class="kw3">float</span><span class="text">
</span><span class="kw1">end</span></pre>

</section><section><h3>Testing via properties</h3>

<ul><li class="fragment roll-in">Our functions are {float} -&gt; {float}</li>
<li class="fragment roll-in">Float are not reals<ul><li class="fragment roll-in">Violate almost every property of the <em>field</em> of Reals</li>
<li class="fragment roll-in">Maybe not additive inverses, commutative?</li>
<li class="fragment roll-in">At the moment the best that we have</li></ul></li>
<li class="fragment roll-in">Very large domains and codomains, what do we do?</li>
<li class="fragment roll-in">Construct probabilistic tests that fail!<ul><li>small percent (1%) of the time</li><li>Based on |Boundary| * |Precision| * |Size|</li></ul></li></ul>

</section><section><h3>Testing observations</h3>

<ul><li class="fragment roll-in">If probabilistic, failure is important!</li>
<li class="fragment roll-in">How do you test two methods that sum an array of floats?</li>
<li class="fragment roll-in"><pre><span class="text">    </span><span class="kw">let</span><span class="text"> </span><span class="id">kahan_test</span><span class="text"> </span><span class="id">arr</span><span class="text"> =
      </span><span class="kw">let</span><span class="text"> </span><span class="id">copy</span><span class="text"> = </span><span class="constant">false</span><span class="text"> </span><span class="kw">in</span><span class="text">
      </span><span class="kw">let</span><span class="text"> </span><span class="id">nsum</span><span class="text"> = </span><span class="kw2">Array</span><span class="text">.</span><span class="id">fold_left</span><span class="text"> (+.) </span><span class="numeric">0</span><span class="text">. </span><span class="kw">in</span><span class="text">
      </span><span class="kw">let</span><span class="text"> </span><span class="id">vals</span><span class="text"> = </span><span class="kw2">Array</span><span class="text">.</span><span class="id">init</span><span class="text"> </span><span class="id">permutations</span><span class="text"> (</span><span class="kw">fun</span><span class="text"> </span><span class="numeric">_</span><span class="text"> -&gt;
        </span><span class="kw">let</span><span class="text"> </span><span class="id">sum_me</span><span class="text"> = </span><span class="id">permute</span><span class="text"> </span><span class="kw4">~copy</span><span class="text"> </span><span class="id">arr</span><span class="text"> </span><span class="kw">in</span><span class="text">
        </span><span class="id">nsum</span><span class="text"> </span><span class="id">sum_me</span><span class="text">, </span><span class="id">sumf</span><span class="text"> </span><span class="id">sum_me</span><span class="text">)
      </span><span class="kw">in</span><span class="text">
      </span><span class="kw">let</span><span class="text"> </span><span class="id">naive_sums</span><span class="text">, </span><span class="id">kahan_sums</span><span class="text"> = </span><span class="kw2">Array</span><span class="text">.</span><span class="id">unzip</span><span class="text"> </span><span class="id">vals</span><span class="text"> </span><span class="kw">in</span><span class="text">
      </span><span class="kw">let</span><span class="text"> </span><span class="id">make_set</span><span class="text">   = </span><span class="kw2">Array</span><span class="text">.</span><span class="id">fold_left</span><span class="text"> (</span><span class="kw">fun</span><span class="text"> </span><span class="id">s</span><span class="text"> </span><span class="id">e</span><span class="text"> -&gt; </span><span class="kw2">Fs</span><span class="text">.</span><span class="id">add</span><span class="text"> </span><span class="id">e</span><span class="text"> </span><span class="id">s</span><span class="text">) </span><span class="kw2">Fs</span><span class="text">.</span><span class="id">empty</span><span class="text"> </span><span class="kw">in</span><span class="text">
      </span><span class="kw">let</span><span class="text"> </span><span class="id">uniq_naive</span><span class="text"> = </span><span class="id">make_set</span><span class="text"> </span><span class="id">naive_sums</span><span class="text"> |&gt; </span><span class="kw2">Fs</span><span class="text">.</span><span class="id">cardinal</span><span class="text"> </span><span class="kw">in</span><span class="text">
      </span><span class="kw">let</span><span class="text"> </span><span class="id">uniq_kahan</span><span class="text"> = </span><span class="id">make_set</span><span class="text"> </span><span class="id">kahan_sums</span><span class="text"> |&gt; </span><span class="kw2">Fs</span><span class="text">.</span><span class="id">cardinal</span><span class="text"> </span><span class="kw">in</span><span class="text">
      </span><span class="id">uniq_kahan</span><span class="text"> &lt;= </span><span class="id">uniq_naive</span><span class="text">)
    </span></pre></li></ul>

</section><section><h3>Testing observations: WIP</h3>

<ol><li class="fragment roll-in">Difficult to structure.<ul><li class="fragment roll-in">Different dependencies:</li>
<li class="fragment roll-in">Util &lt; Statistics &lt; Regression</li>
<li class="fragment roll-in">Util &lt; Regression &lt; Statistics</li></ul></li>
<li class="fragment roll-in">Difficult to convey to user.</li></ol>

</section><section><h3>Thanks and questions.</h3><ul><li><a href='http://www.hammerlab.org/'>Hammer Lab - www.hammerlab.org</a><ul><li>Jeff Hammerbacher</li><li>Sebastien Mondet</li><li>Isaac Hodes</li></ul></li><li>Carmelo Piccione</li><li>Shoulders of giants:<ul><li><a href='http://www.ocaml.info/'>Markus Mottl</a>, <code>Lacaml</code></li><li><a href='https://github.com/Chris00'>Christophe Troestler</a>, <code>L-BFGS</code></li></ul></li></ul>

</section><section><h3>Presentation Credit</h3>

<ul><li><a href='https://github.com/smondet/makmash'>Makmash</a></li><li><a href='https://github.com/hakimel/reveal.js'>Reveal.js</a></li></ul>

</section><section><h3>Origin of Oml (Ocaml Math Library)</h3>

<ol><li class="fragment roll-in">First things first; the name!<ul><li class="fragment roll-in">Hardest problem in computer science
<!-- comment: Not a grand overture, I just want to switch to the directory quickly.  --></li></ul></li>
<li class="fragment roll-in">Started amassing methods over my career.<ul><li>Using <code>SVD</code> for regression
<!-- comment: to dis-entangle very collinear (financial) data. --></li><li>Kept rewriting Naive Bayes
<!-- simple classification. to aggregate most common features. --></li><li>Can&#39;t remember the rules for performing inference tests.</li></ul></li>
<li class="fragment roll-in">I&#39;m a <em>type</em> addict<ul><li><code>Array.fold_left</code> ... leads to thinking.</li><li><code>:set +t</code> in my <code>~/.ghci</code></li></ul></li></ol>

<!-- comment:
    As many people at this conference undoubtedly can attest are useful.
    - Shape how we think about a problem
  -->

</section><section><h3>Origin of Oml</h3>

<p>Take an amino acid sequence</p>
<img class="stretch" src="img/glucagon.png" alt="Glucagon" /></section><section><h3>Origin of Oml:</h3>

<p>Make a prediction</p>
<img class="stretch" src="img/mhc_table.png" alt="Mhc" /><!-- Observations.
    - I'm not a trained biologists/bioinformatician
    - Don't have these amino acids memorized
      - A is Alanine
      - L is Leucine
      - Y is Tyrocine
    - Using types I can embed knowledge that I learn about the domain:
      1. guide the analysis.
      2. the compiler checks whether you're knowledge of the domain is consistent.
    - Repeated problem in lots of domains:
      - Finance (contracts, calculations)
    - Not the _most important_ thing, but not 0 value.
-->

</section><section><h3>Meta</h3>

<ul><li>Compiled on <code>Thu, 04 Feb 2016 00:31:24 -0500</code></li><li>Git: <code>3d176c6-dirty</code></li></ul></section></div></div>

    

    <!--
    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>
    -->
    <script src="code.js"></script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        //center: true,
        center: false,

        slideNumber: true,
        //width: 1000,
        height: 1000,
        //margin: 0.1,
        // Bounds for smallest/largest possible scale to apply to content
        //minScale: 0.2,
        //maxScale: 1.0,


        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none

        // Parallax scrolling
        // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
        // parallaxBackgroundSize: '2100px 900px',

        // Optional libraries used to extend on reveal.js
        dependencies: [
//          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
//          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
//          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
//          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
//          { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
//          { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
      });

    </script>

  </body>
</html>
